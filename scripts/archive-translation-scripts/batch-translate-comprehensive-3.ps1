# Comprehensive Translation Script - Part 3 (Refund-Save)
$poFile = "c:\Users\janni\Local Sites\yogaibiza\app\public\wp-content\plugins\ltl-bookings\languages\de_DE.po"

$translations = @{
    'Refunded at' = 'Rückerstattet am'
    'Reminders processed.' = 'Erinnerungen verarbeitet.'
    'Remove' = 'Entfernen'
    'Reply-To:' = 'Antworten an:'
    'Report draft created in Outbox.' = 'Berichtsentwurf im Postausgang erstellt.'
    'Report generated.' = 'Bericht generiert.'
    'Report stored.' = 'Bericht gespeichert.'
    'Required for company invoices.' = 'Erforderlich für Firmenrechnungen.'
    'Resource #' = 'Ressource #'
    'Resources are rooms, equipment, or capacities. Link them to services to control availability.' = 'Ressourcen sind Räume, Ausstattung oder Kapazitäten. Verknüpfen Sie sie mit Dienstleistungen, um die Verfügbarkeit zu steuern.'
    'Result' = 'Ergebnis'
    'Retention policies are automatically applied via scheduled tasks. You can manually trigger cleanup here:' = 'Aufbewahrungsrichtlinien werden automatisch über geplante Aufgaben angewendet. Sie können die Bereinigung hier manuell auslösen:'
    'Retention settings saved.' = 'Aufbewahrungseinstellungen gespeichert.'
    'Return to booking page' = 'Zurück zur Buchungsseite'
    'Reusable subjects and bodies for emails (automations, AI drafts, and manual replies).' = 'Wiederverwendbare Betreffe und Texte für E-Mails (Automatisierungen, KI-Entwürfe und manuelle Antworten).'
    'Revenue' = 'Umsatz'
    'Revenue (gross)' = 'Umsatz (brutto)'
    'Review upcoming unassigned bookings and propose room assignments. In Human-in-the-Loop mode, proposals create drafts in the Outbox.' = 'Überprüfen Sie bevorstehende nicht zugewiesene Buchungen und schlagen Sie Zimmerzuweisungen vor. Im Human-in-the-Loop-Modus erstellen Vorschläge Entwürfe im Postausgang.'
    'Review, edit, approve, and execute AI-assisted actions.' = 'Überprüfen, bearbeiten, genehmigen und ausführen Sie KI-unterstützte Aktionen.'
    'Room' = 'Zimmer'
    'Room #' = 'Zimmer #'
    'Room assigned.' = 'Zimmer zugewiesen.'
    'Room Assignment' = 'Zimmerzuweisung'
    'Room assignment dependencies not loaded.' = 'Zimmerzuweisungsabhängigkeiten nicht geladen.'
    'Room assignment queued.' = 'Zimmerzuweisung in Warteschlange.'
    'Room Assistant' = 'Zimmer-Assistent'
    'Room costs' = 'Zimmerkosten'
    'Room preference' = 'Zimmerpräferenz'
    'Room proposal sent to Outbox.' = 'Zimmervorschlag an Postausgang gesendet.'
    'Room Type' = 'Raumtyp'
    'Room Types' = 'Raumtypen'
    'Room types define the different accommodation options you offer. Create your first room type to start accepting bookings.' = 'Raumtypen definieren die verschiedenen Unterkunftsoptionen, die Sie anbieten. Erstellen Sie Ihren ersten Raumtyp, um Buchungen anzunehmen.'
    'Rooms are the bookable units (e.g. Room 101, Room 102). Link them to room types to control availability.' = 'Zimmer sind die buchbaren Einheiten (z.B. Zimmer 101, Zimmer 102). Verknüpfen Sie sie mit Raumtypen, um die Verfügbarkeit zu steuern.'
    'Roundness of buttons and inputs' = 'Rundung von Buttons und Eingabefeldern'
    'Rows' = 'Zeilen'
    'Rule added.' = 'Regel hinzugefügt.'
    'Rule deleted.' = 'Regel gelöscht.'
    'Rule not found.' = 'Regel nicht gefunden.'
    'Rule saved.' = 'Regel gespeichert.'
    'Rule updated.' = 'Regel aktualisiert.'
    'Run Cleanup Now' = 'Bereinigung jetzt ausführen'
    'Run migrations' = 'Migrationen ausführen'
    'Run Now' = 'Jetzt ausführen'
    'Run Retention Cleanup' = 'Aufbewahrungsbereinigung ausführen'
    'Run retention cleanup now?' = 'Aufbewahrungsbereinigung jetzt ausführen?'
    'Run system check' = 'Systemprüfung ausführen'
    'Run system diagnostics (read-only).' = 'Systemdiagnose ausführen (nur Lesezugriff).'
    'Run triggered. Check Outbox for drafts.' = 'Ausführung ausgelöst. Prüfen Sie den Postausgang auf Entwürfe.'
    'Runs database migrations again. Can be run multiple times (uses dbDelta).' = 'Führt Datenbankmigrationen erneut aus. Kann mehrmals ausgeführt werden (verwendet dbDelta).'
    'Sat' = 'Sa'
    'Save AI Settings' = 'KI-Einstellungen speichern'
    'Save Customer' = 'Kunde speichern'
    'Save Design' = 'Design speichern'
    'Save Draft' = 'Entwurf speichern'
    'Save Retention Settings' = 'Aufbewahrungseinstellungen speichern'
    'Save Rule' = 'Regel speichern'
    'Save Settings' = 'Einstellungen speichern'
    'Save working hours' = 'Arbeitszeiten speichern'
    'Schedule Details' = 'Zeitplan-Details'
    'Scope' = 'Bereich'
    'Search...' = 'Suchen...'
    'Seats' = 'Plätze'
    'Secondary' = 'Sekundär'
    'Secondary button border and text (outline).' = 'Sekundär-Button Rand und Text (Umriss).'
    'Secondary button hover fill background and border.' = 'Sekundär-Button Hover-Hintergrund und Rand.'
    'Secondary Color' = 'Sekundärfarbe'
    'Secondary Hover Color' = 'Sekundär-Hover-Farbe'
    'Security' = 'Sicherheit'
    'Security check failed' = 'Sicherheitsprüfung fehlgeschlagen'
    'See what is available and pick your preferred time in seconds.' = 'Sehen Sie, was verfügbar ist, und wählen Sie in Sekunden Ihre bevorzugte Zeit.'
    'Select appointments using checkboxes, choose an action, then click Apply' = 'Wählen Sie Termine über Kontrollkästchen aus, wählen Sie eine Aktion und klicken Sie auf Anwenden'
    'Select bulk action' = 'Massenaktion auswählen'
    'Select log file' = 'Protokolldatei auswählen'
    'Select resources that can perform this service.' = 'Wählen Sie Ressourcen aus, die diese Dienstleistung ausführen können.'
    'Select room type' = 'Raumtyp auswählen'
    'Select the resources that can be used for this service. If none are selected, all available resources will be considered.' = 'Wählen Sie die Ressourcen aus, die für diese Dienstleistung verwendet werden können. Wenn keine ausgewählt sind, werden alle verfügbaren Ressourcen berücksichtigt.'
    'Select...' = 'Auswählen...'
    'Selected room is no longer available.' = 'Ausgewähltes Zimmer ist nicht mehr verfügbar.'
    'Send confirmation email to customer' = 'Bestätigungs-E-Mail an Kunden senden'
    'Send email to admin on new booking' = 'E-Mail an Admin bei neuer Buchung senden'
    'Send emails via SMTP instead of the server mail function' = 'E-Mails über SMTP statt der Server-Mail-Funktion senden'
    'Send Test Email' = 'Test-E-Mail senden'
    'Send test email to:' = 'Test-E-Mail senden an:'
    'Send to AI' = 'An KI senden'
    'Sender Info' = 'Absenderinformationen'
    'Sent at:' = 'Gesendet am:'
    'Server error (HTTP %d)' = 'Serverfehler (HTTP %d)'
    'Service Booking (Appointments)' = 'Dienstleistungsbuchung (Termine)'
    'Service Card' = 'Service-Karte'
    'Service duration in minutes' = 'Dienstleistungsdauer in Minuten'
    'Service saved successfully.' = 'Dienstleistung erfolgreich gespeichert.'
    'Services define what you offer to your customers. Create your first service to start accepting appointments.' = 'Dienstleistungen definieren, was Sie Ihren Kunden anbieten. Erstellen Sie Ihre erste Dienstleistung, um Termine anzunehmen.'
}

$content = Get-Content $poFile -Raw -Encoding UTF8
$translatedCount = 0

foreach ($english in $translations.Keys) {
    $german = $translations[$english]
    $pattern = "msgid `"$([regex]::Escape($english))`"`r?`nmsgstr `"`""
    $replacement = "msgid `"$english`"`nmsgstr `"$german`""
    
    if ($content -match $pattern) {
        $content = $content -replace $pattern, $replacement
        $translatedCount++
        Write-Host "Translated: $english -> $german" -ForegroundColor Green
    }
}

$content | Out-File $poFile -Encoding UTF8 -NoNewline

Write-Host ""
Write-Host "Batch Translation Complete: $translatedCount strings" -ForegroundColor Cyan
